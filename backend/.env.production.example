# ÖDP-MD² Production Environment Configuration
# Copy this to .env.production and customize with your values

# ============================================
# SERVER CONFIGURATION
# ============================================
NODE_ENV=production
PORT=3000
FRONTEND_URL=https://md2.oedp.de

# ============================================
# DATABASE CONFIGURATION
# ============================================
# Production PostgreSQL connection
DATABASE_URL=postgresql://oedp_prod_user:CHANGE_THIS_PASSWORD@localhost:5432/oedp_md2_production

# Connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=5000
DB_IDLE_TIMEOUT=30000

# ============================================
# SECURITY - JWT CONFIGURATION
# ============================================
# CRITICAL: Generate a strong random secret
# Run: openssl rand -base64 64
JWT_SECRET=CHANGE_THIS_TO_A_STRONG_RANDOM_SECRET_AT_LEAST_64_CHARACTERS_LONG
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# Cookie settings
COOKIE_SECRET=CHANGE_THIS_TO_ANOTHER_STRONG_RANDOM_SECRET

# ============================================
# EMAIL / SMTP CONFIGURATION
# ============================================
# Production SMTP server
SMTP_HOST=smtp.mailgun.org
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=postmaster@mg.oedp.de
SMTP_PASS=CHANGE_THIS_TO_YOUR_SMTP_PASSWORD
SMTP_FROM=ÖDP-MD² <noreply@oedp.de>

# Email rate limiting
EMAIL_RATE_LIMIT=100
EMAIL_RATE_WINDOW=3600000

# ============================================
# FILE UPLOAD CONFIGURATION
# ============================================
MAX_FILE_SIZE=5242880
UPLOAD_DIR=/var/oedp-md2/uploads

# S3 Configuration (optional, for scalable storage)
USE_S3_STORAGE=false
S3_BUCKET=oedp-md2-uploads
S3_REGION=eu-central-1
S3_ACCESS_KEY=
S3_SECRET_KEY=

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
AUTH_RATE_LIMIT_MAX=5
AUTH_RATE_LIMIT_WINDOW=900000

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info
LOG_FILE=/var/log/oedp-md2/app.log
LOG_MAX_SIZE=10485760
LOG_MAX_FILES=10

# ============================================
# SECURITY SETTINGS
# ============================================
BCRYPT_ROUNDS=12
ENABLE_CORS=true
CORS_ORIGINS=https://md2.oedp.de,https://www.oedp.de

# Session timeout (milliseconds)
SESSION_TIMEOUT=3600000

# ============================================
# FEATURE FLAGS
# ============================================
ENABLE_REGISTRATION=true
ENABLE_EMAIL_VERIFICATION=true
REQUIRE_EMAIL_VERIFICATION=false
ENABLE_2FA=false

# ============================================
# MONITORING & ANALYTICS
# ============================================
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# New Relic (optional)
NEW_RELIC_LICENSE_KEY=
NEW_RELIC_APP_NAME=oedp-md2-production

# ============================================
# BACKUP CONFIGURATION
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=oedp-md2-backups

# ============================================
# ADMIN CONFIGURATION
# ============================================
# Default admin (created on first run)
DEFAULT_ADMIN_EMAIL=admin@oedp.de
DEFAULT_ADMIN_PASSWORD=CHANGE_THIS_IMMEDIATELY_AFTER_FIRST_LOGIN
DEFAULT_ADMIN_NAME=System Administrator

# ============================================
# EXTERNAL SERVICES
# ============================================
# ÖDP Membership API (if available)
MEMBERSHIP_API_URL=
MEMBERSHIP_API_KEY=

# LDAP Integration (optional)
LDAP_ENABLED=false
LDAP_URL=
LDAP_BIND_DN=
LDAP_BIND_PASSWORD=

# ============================================
# PERFORMANCE & CACHING
# ============================================
ENABLE_CACHE=true
CACHE_TTL=3600
REDIS_URL=redis://localhost:6379

# ============================================
# SSL/TLS CONFIGURATION
# ============================================
SSL_CERT_PATH=/etc/ssl/certs/oedp-md2.crt
SSL_KEY_PATH=/etc/ssl/private/oedp-md2.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# ============================================
# MAINTENANCE MODE
# ============================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=System wird aktualisiert. Bitte versuchen Sie es in einigen Minuten erneut.

# ============================================
# AUDIT & COMPLIANCE
# ============================================
AUDIT_LOG_RETENTION_DAYS=1095
GDPR_DATA_RETENTION_DAYS=1095
ENABLE_AUDIT_EXPORT=true

# ============================================
# WEBHOOKS (Phase 2)
# ============================================
WEBHOOK_SECRET=
WEBHOOK_TIMEOUT=5000

# ============================================
# NOTES
# ============================================
# 1. NEVER commit this file with real credentials
# 2. Use a secrets management service (AWS Secrets Manager, HashiCorp Vault, etc.)
# 3. Rotate JWT_SECRET regularly (every 90 days recommended)
# 4. Enable 2FA for admin accounts in production
# 5. Monitor logs for suspicious activity
# 6. Set up automated backups
# 7. Use strong, unique passwords for all services
# 8. Enable rate limiting to prevent abuse
# 9. Regularly update dependencies
# 10. Implement health checks and monitoring
